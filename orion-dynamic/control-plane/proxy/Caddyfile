# Local-only HTTPS on https://localhost (port 443), proxying to the API service.
# Uses Caddy's internal CA (self-signed). Browser will show a warning unless you trust Caddy's local root CA.

localhost:443 {
    tls internal
    encode zstd gzip

    # --- FRONT WEB (service: web) ---
    root * /srv/web
    file_server

    # --- BACKEND API (service: api) ---
    handle_path /api/* {
        reverse_proxy api:8080
    }
}

host.docker.internal:443 {
    tls internal
    encode zstd gzip

    root * /srv/web
    file_server

    handle_path /api/* {
        reverse_proxy api:8080
    }
}